import{a as z,r as ne,_ as l,x as Se,n as Be,s as Xe,t as H,q as v,d as ie,v as Q,aD as Ve,b as u,C as M,I as De,z as Z,aQ as je,T as We,P as He,k as Ze,aI as J,m as Me,aH as Fe,a8 as Ke,bK as Qe,bL as Je,bM as qe,bN as et,ae as tt,A as ot,R as nt,bO as Ie,l as Le,aa as fe,ab as it,aq as rt,bx as at}from"./index-BNbA7v75.js";import{a1 as lt,a2 as st,h as Ne,d as F,a as ut}from"./_plugin-vue_export-helper-B53X9KRV.js";import{a as ct,u as ke,g as Ee}from"./css-Cn-XZvMJ.js";import{d as vt,D as pt,g as ft,i as gt}from"./index-DhYPhdFh.js";import{K as Oe}from"./pickAttrs-9kOryGu2.js";var dt="[object Number]";function mt(e){return typeof e=="number"||lt(e)&&st(e)==dt}function wt(e){const o=z(null),i=ne(l({},e)),t=z([]),n=s=>{o.value===null&&(t.value=[],o.value=Ne(()=>{let p;t.value.forEach(g=>{p=l(l({},p),g)}),l(i,p),o.value=null})),t.value.push(s)};return Se(()=>{o.value&&Ne.cancel(o.value)}),[i,n]}function $e(e,o,i,t){const n=o+i,s=(i-t)/2;if(i>t){if(o>0)return{[e]:s};if(o<0&&n<t)return{[e]:-s}}else if(o<0||n>t)return{[e]:o<0?s:-s};return{}}function Ct(e,o,i,t){const{width:n,height:s}=ct();let p=null;return e<=n&&o<=s?p={x:0,y:0}:(e>n||o>s)&&(p=l(l({},$e("x",i,e,n)),$e("y",t,o,s))),p}var ht=function(e,o){var i={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&o.indexOf(t)<0&&(i[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,t=Object.getOwnPropertySymbols(e);n<t.length;n++)o.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t[n])&&(i[t[n]]=e[t[n]]);return i};const Ae=Symbol("previewGroupContext"),xe={provide:e=>{Be(Ae,e)},inject:()=>Xe(Ae,{isPreviewGroup:H(!1),previewUrls:v(()=>new Map),setPreviewUrls:()=>{},current:z(null),setCurrent:()=>{},setShowPreview:()=>{},setMousePosition:()=>{},registerImage:null,rootClassName:""})},bt=()=>({previewPrefixCls:String,preview:{type:[Boolean,Object],default:!0},icons:{type:Object,default:()=>({})}}),yt=ie({compatConfig:{MODE:3},name:"PreviewGroup",inheritAttrs:!1,props:bt(),setup(e,o){let{slots:i}=o;const t=v(()=>{const a={visible:void 0,onVisibleChange:()=>{},getContainer:void 0,current:0};return typeof e.preview=="object"?Ge(e.preview,a):a}),n=ne(new Map),s=z(),p=v(()=>t.value.visible),g=v(()=>t.value.getContainer),S=(a,P)=>{var y,L;(L=(y=t.value).onVisibleChange)===null||L===void 0||L.call(y,a,P)},[I,f]=ke(!!p.value,{value:p,onChange:S}),m=z(null),D=v(()=>p.value!==void 0),d=v(()=>Array.from(n.keys())),C=v(()=>d.value[t.value.current]),h=v(()=>new Map(Array.from(n).filter(a=>{let[,{canPreview:P}]=a;return!!P}).map(a=>{let[P,{url:y}]=a;return[P,y]}))),w=function(a,P){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;n.set(a,{url:P,canPreview:y})},b=a=>{s.value=a},j=a=>{m.value=a},T=function(a,P){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const L=()=>{n.delete(a)};return n.set(a,{url:P,canPreview:y}),L},x=a=>{a==null||a.stopPropagation(),f(!1),j(null)};return Q(C,a=>{b(a)},{immediate:!0,flush:"post"}),Ve(()=>{I.value&&D.value&&b(C.value)},{flush:"post"}),xe.provide({isPreviewGroup:H(!0),previewUrls:h,setPreviewUrls:w,current:s,setCurrent:b,setShowPreview:f,setMousePosition:j,registerImage:T}),()=>{const a=ht(t.value,[]);return u(De,null,[i.default&&i.default(),u(Te,M(M({},a),{},{"ria-hidden":!I.value,visible:I.value,prefixCls:e.previewPrefixCls,onClose:x,mousePosition:m.value,src:h.value.get(s.value),icons:e.icons,getContainer:g.value}),null)])}}}),ze=yt,W={x:0,y:0},St=l(l({},vt()),{src:String,alt:String,rootClassName:String,icons:{type:Object,default:()=>({})}}),Te=ie({compatConfig:{MODE:3},name:"Preview",inheritAttrs:!1,props:St,emits:["close","afterClose"],setup(e,o){let{emit:i,attrs:t}=o;const{rotateLeft:n,rotateRight:s,zoomIn:p,zoomOut:g,close:S,left:I,right:f,flipX:m,flipY:D}=ne(e.icons),d=H(1),C=H(0),h=ne({x:1,y:1}),[w,b]=wt(W),j=()=>i("close"),T=H(),x=ne({originX:0,originY:0,deltaX:0,deltaY:0}),a=H(!1),P=xe.inject(),{previewUrls:y,current:L,isPreviewGroup:q,setCurrent:A}=P,U=v(()=>y.value.size),B=v(()=>Array.from(y.value.keys())),N=v(()=>B.value.indexOf(L.value)),ge=v(()=>q.value?y.value.get(L.value):e.src),k=v(()=>q.value&&U.value>1),R=H({wheelDirection:0}),ee=()=>{d.value=1,C.value=0,h.x=1,h.y=1,b(W),i("afterClose")},c=r=>{r?d.value+=.5:d.value++,b(W)},E=r=>{d.value>1&&(r?d.value-=.5:d.value--),b(W)},O=()=>{C.value+=90},X=()=>{C.value-=90},re=()=>{h.x=-h.x},de=()=>{h.y=-h.y},ae=r=>{r.preventDefault(),r.stopPropagation(),N.value>0&&A(B.value[N.value-1])},le=r=>{r.preventDefault(),r.stopPropagation(),N.value<U.value-1&&A(B.value[N.value+1])},te=Z({[`${e.prefixCls}-moving`]:a.value}),me=`${e.prefixCls}-operations-operation`,we=`${e.prefixCls}-operations-icon`,se=[{icon:S,onClick:j,type:"close"},{icon:p,onClick:()=>c(),type:"zoomIn"},{icon:g,onClick:()=>E(),type:"zoomOut",disabled:v(()=>d.value===1)},{icon:s,onClick:O,type:"rotateRight"},{icon:n,onClick:X,type:"rotateLeft"},{icon:m,onClick:re,type:"flipX"},{icon:D,onClick:de,type:"flipY"}],ue=()=>{if(e.visible&&a.value){const r=T.value.offsetWidth*d.value,$=T.value.offsetHeight*d.value,{left:G,top:V}=Ee(T.value),_=C.value%180!==0;a.value=!1;const Y=Ct(_?$:r,_?r:$,G,V);Y&&b(l({},Y))}},Ce=r=>{r.button===0&&(r.preventDefault(),r.stopPropagation(),x.deltaX=r.pageX-w.x,x.deltaY=r.pageY-w.y,x.originX=w.x,x.originY=w.y,a.value=!0)},ce=r=>{e.visible&&a.value&&b({x:r.pageX-x.deltaX,y:r.pageY-x.deltaY})},he=r=>{if(!e.visible)return;r.preventDefault();const $=r.deltaY;R.value={wheelDirection:$}},be=r=>{!e.visible||!k.value||(r.preventDefault(),r.keyCode===Oe.LEFT?N.value>0&&A(B.value[N.value-1]):r.keyCode===Oe.RIGHT&&N.value<U.value-1&&A(B.value[N.value+1]))},ve=()=>{e.visible&&(d.value!==1&&(d.value=1),(w.x!==W.x||w.y!==W.y)&&b(W))};let oe=()=>{};return Se(()=>{Q([()=>e.visible,a],()=>{oe();let r,$;const G=F(window,"mouseup",ue,!1),V=F(window,"mousemove",ce,!1),_=F(window,"wheel",he,{passive:!1}),Y=F(window,"keydown",be,!1);try{window.top!==window.self&&(r=F(window.top,"mouseup",ue,!1),$=F(window.top,"mousemove",ce,!1))}catch{}oe=()=>{G.remove(),V.remove(),_.remove(),Y.remove(),r&&r.remove(),$&&$.remove()}},{flush:"post",immediate:!0}),Q([R],()=>{const{wheelDirection:r}=R.value;r>0?E(!0):r<0&&c(!0)})}),je(()=>{oe()}),()=>{const{visible:r,prefixCls:$,rootClassName:G}=e;return u(pt,M(M({},t),{},{transitionName:e.transitionName,maskTransitionName:e.maskTransitionName,closable:!1,keyboard:!0,prefixCls:$,onClose:j,afterClose:ee,visible:r,wrapClassName:te,rootClassName:G,getContainer:e.getContainer}),{default:()=>[u("div",{class:[`${e.prefixCls}-operations-wrapper`,G]},[u("ul",{class:`${e.prefixCls}-operations`},[se.map(V=>{let{icon:_,onClick:Y,type:Pe,disabled:pe}=V;return u("li",{class:Z(me,{[`${e.prefixCls}-operations-operation-disabled`]:pe&&(pe==null?void 0:pe.value)}),onClick:Y,key:Pe},[We(_,{class:we})])})])]),u("div",{class:`${e.prefixCls}-img-wrapper`,style:{transform:`translate3d(${w.x}px, ${w.y}px, 0)`}},[u("img",{onMousedown:Ce,onDblclick:ve,ref:T,class:`${e.prefixCls}-img`,src:ge.value,alt:e.alt,style:{transform:`scale3d(${h.x*d.value}, ${h.y*d.value}, 1) rotate(${C.value}deg)`}},null)]),k.value&&u("div",{class:Z(`${e.prefixCls}-switch-left`,{[`${e.prefixCls}-switch-left-disabled`]:N.value<=0}),onClick:ae},[I]),k.value&&u("div",{class:Z(`${e.prefixCls}-switch-right`,{[`${e.prefixCls}-switch-right-disabled`]:N.value>=U.value-1}),onClick:le},[f])]})}}});var xt=function(e,o){var i={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&o.indexOf(t)<0&&(i[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,t=Object.getOwnPropertySymbols(e);n<t.length;n++)o.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t[n])&&(i[t[n]]=e[t[n]]);return i};const Re=()=>({src:String,wrapperClassName:String,wrapperStyle:{type:Object,default:void 0},rootClassName:String,prefixCls:String,previewPrefixCls:String,previewMask:{type:[Boolean,Function],default:void 0},placeholder:He.any,fallback:String,preview:{type:[Boolean,Object],default:!0},onClick:{type:Function},onError:{type:Function}}),Ge=(e,o)=>{const i=l({},e);return Object.keys(o).forEach(t=>{e[t]===void 0&&(i[t]=o[t])}),i};let Pt=0;const _e=ie({compatConfig:{MODE:3},name:"VcImage",inheritAttrs:!1,props:Re(),emits:["click","error"],setup(e,o){let{attrs:i,slots:t,emit:n}=o;const s=v(()=>e.prefixCls),p=v(()=>`${s.value}-preview`),g=v(()=>{const c={visible:void 0,onVisibleChange:()=>{},getContainer:void 0};return typeof e.preview=="object"?Ge(e.preview,c):c}),S=v(()=>{var c;return(c=g.value.src)!==null&&c!==void 0?c:e.src}),I=v(()=>e.placeholder&&e.placeholder!==!0||t.placeholder),f=v(()=>g.value.visible),m=v(()=>g.value.getContainer),D=v(()=>f.value!==void 0),d=(c,E)=>{var O,X;(X=(O=g.value).onVisibleChange)===null||X===void 0||X.call(O,c,E)},[C,h]=ke(!!f.value,{value:f,onChange:d}),w=z(I.value?"loading":"normal");Q(()=>e.src,()=>{w.value=I.value?"loading":"normal"});const b=z(null),j=v(()=>w.value==="error"),T=xe.inject(),{isPreviewGroup:x,setCurrent:a,setShowPreview:P,setMousePosition:y,registerImage:L}=T,q=z(Pt++),A=v(()=>e.preview&&!j.value),U=()=>{w.value="normal"},B=c=>{w.value="error",n("error",c)},N=c=>{if(!D.value){const{left:E,top:O}=Ee(c.target);x.value?(a(q.value),y({x:E,y:O})):b.value={x:E,y:O}}x.value?P(!0):h(!0),n("click",c)},ge=()=>{h(!1),D.value||(b.value=null)},k=z(null);Q(()=>k,()=>{w.value==="loading"&&k.value.complete&&(k.value.naturalWidth||k.value.naturalHeight)&&U()});let R=()=>{};Se(()=>{Q([S,A],()=>{if(R(),!x.value)return()=>{};R=L(q.value,S.value,A.value),A.value||R()},{flush:"post",immediate:!0})}),je(()=>{R()});const ee=c=>mt(c)?c+"px":c;return()=>{const{prefixCls:c,wrapperClassName:E,fallback:O,src:X,placeholder:re,wrapperStyle:de,rootClassName:ae}=e,{width:le,height:te,crossorigin:me,decoding:we,alt:se,sizes:ue,srcset:Ce,usemap:ce,class:he,style:be}=i,ve=g.value,{icons:oe,maskClassName:r}=ve,$=xt(ve,["icons","maskClassName"]),G=Z(c,E,ae,{[`${c}-error`]:j.value}),V=j.value&&O?O:S.value,_={crossorigin:me,decoding:we,alt:se,sizes:ue,srcset:Ce,usemap:ce,width:le,height:te,class:Z(`${c}-img`,{[`${c}-img-placeholder`]:re===!0},he),style:l({height:ee(te)},be)};return u(De,null,[u("div",{class:G,onClick:A.value?N:Y=>{n("click",Y)},style:l({width:ee(le),height:ee(te)},de)},[u("img",M(M(M({},_),j.value&&O?{src:O}:{onLoad:U,onError:B,src:X}),{},{ref:k}),null),w.value==="loading"&&u("div",{"aria-hidden":"true",class:`${c}-placeholder`},[re||t.placeholder&&t.placeholder()]),t.previewMask&&A.value&&u("div",{class:[`${c}-mask`,r]},[t.previewMask()])]),!x.value&&A.value&&u(Te,M(M({},$),{},{"aria-hidden":!C.value,visible:C.value,prefixCls:p.value,onClose:ge,mousePosition:b.value,src:V,alt:se,getContainer:m.value,icons:oe,rootClassName:ae}),null)])}}});_e.PreviewGroup=ze;const Mt=_e,ye=e=>({position:e||"absolute",inset:0}),It=e=>{const{iconCls:o,motionDurationSlow:i,paddingXXS:t,marginXXS:n,prefixCls:s}=e;return{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",background:new J("#000").setAlpha(.5).toRgbString(),cursor:"pointer",opacity:0,transition:`opacity ${i}`,[`.${s}-mask-info`]:l(l({},Fe),{padding:`0 ${t}px`,[o]:{marginInlineEnd:n,svg:{verticalAlign:"baseline"}}})}},Nt=e=>{const{previewCls:o,modalMaskBg:i,paddingSM:t,previewOperationColorDisabled:n,motionDurationSlow:s}=e,p=new J(i).setAlpha(.1),g=p.clone().setAlpha(.2);return{[`${o}-operations`]:l(l({},Ke(e)),{display:"flex",flexDirection:"row-reverse",alignItems:"center",color:e.previewOperationColor,listStyle:"none",background:p.toRgbString(),pointerEvents:"auto","&-operation":{marginInlineStart:t,padding:t,cursor:"pointer",transition:`all ${s}`,userSelect:"none","&:hover":{background:g.toRgbString()},"&-disabled":{color:n,pointerEvents:"none"},"&:last-of-type":{marginInlineStart:0}},"&-progress":{position:"absolute",left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%)"},"&-icon":{fontSize:e.previewOperationSize}})}},Ot=e=>{const{modalMaskBg:o,iconCls:i,previewOperationColorDisabled:t,previewCls:n,zIndexPopup:s,motionDurationSlow:p}=e,g=new J(o).setAlpha(.1),S=g.clone().setAlpha(.2);return{[`${n}-switch-left, ${n}-switch-right`]:{position:"fixed",insetBlockStart:"50%",zIndex:s+1,display:"flex",alignItems:"center",justifyContent:"center",width:e.imagePreviewSwitchSize,height:e.imagePreviewSwitchSize,marginTop:-e.imagePreviewSwitchSize/2,color:e.previewOperationColor,background:g.toRgbString(),borderRadius:"50%",transform:"translateY(-50%)",cursor:"pointer",transition:`all ${p}`,pointerEvents:"auto",userSelect:"none","&:hover":{background:S.toRgbString()},"&-disabled":{"&, &:hover":{color:t,background:"transparent",cursor:"not-allowed",[`> ${i}`]:{cursor:"not-allowed"}}},[`> ${i}`]:{fontSize:e.previewOperationSize}},[`${n}-switch-left`]:{insetInlineStart:e.marginSM},[`${n}-switch-right`]:{insetInlineEnd:e.marginSM}}},$t=e=>{const{motionEaseOut:o,previewCls:i,motionDurationSlow:t,componentCls:n}=e;return[{[`${n}-preview-root`]:{[i]:{height:"100%",textAlign:"center",pointerEvents:"none"},[`${i}-body`]:l(l({},ye()),{overflow:"hidden"}),[`${i}-img`]:{maxWidth:"100%",maxHeight:"100%",verticalAlign:"middle",transform:"scale3d(1, 1, 1)",cursor:"grab",transition:`transform ${t} ${o} 0s`,userSelect:"none",pointerEvents:"auto","&-wrapper":l(l({},ye()),{transition:`transform ${t} ${o} 0s`,display:"flex",justifyContent:"center",alignItems:"center","&::before":{display:"inline-block",width:1,height:"50%",marginInlineEnd:-1,content:'""'}})},[`${i}-moving`]:{[`${i}-preview-img`]:{cursor:"grabbing","&-wrapper":{transitionDuration:"0s"}}}}},{[`${n}-preview-root`]:{[`${i}-wrap`]:{zIndex:e.zIndexPopup}}},{[`${n}-preview-operations-wrapper`]:{position:"fixed",insetBlockStart:0,insetInlineEnd:0,zIndex:e.zIndexPopup+1,width:"100%"},"&":[Nt(e),Ot(e)]}]},At=e=>{const{componentCls:o}=e;return{[o]:{position:"relative",display:"inline-block",[`${o}-img`]:{width:"100%",height:"auto",verticalAlign:"middle"},[`${o}-img-placeholder`]:{backgroundColor:e.colorBgContainerDisabled,backgroundImage:"url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTQuNSAyLjVoLTEzQS41LjUgMCAwIDAgMSAzdjEwYS41LjUgMCAwIDAgLjUuNWgxM2EuNS41IDAgMCAwIC41LS41VjNhLjUuNSAwIDAgMC0uNS0uNXpNNS4yODEgNC43NWExIDEgMCAwIDEgMCAyIDEgMSAwIDAgMSAwLTJ6bTguMDMgNi44M2EuMTI3LjEyNyAwIDAgMS0uMDgxLjAzSDIuNzY5YS4xMjUuMTI1IDAgMCAxLS4wOTYtLjIwN2wyLjY2MS0zLjE1NmEuMTI2LjEyNiAwIDAgMSAuMTc3LS4wMTZsLjAxNi4wMTZMNy4wOCAxMC4wOWwyLjQ3LTIuOTNhLjEyNi4xMjYgMCAwIDEgLjE3Ny0uMDE2bC4wMTUuMDE2IDMuNTg4IDQuMjQ0YS4xMjcuMTI3IDAgMCAxLS4wMi4xNzV6IiBmaWxsPSIjOEM4QzhDIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48L3N2Zz4=')",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:"30%"},[`${o}-mask`]:l({},It(e)),[`${o}-mask:hover`]:{opacity:1},[`${o}-placeholder`]:l({},ye())}}},Dt=e=>{const{previewCls:o}=e;return{[`${o}-root`]:ut(e,"zoom"),"&":gt(e,!0)}},Ye=Ze("Image",e=>{const o=`${e.componentCls}-preview`,i=Me(e,{previewCls:o,modalMaskBg:new J("#000").setAlpha(.45).toRgbString(),imagePreviewSwitchSize:e.controlHeightLG});return[At(i),$t(i),ft(Me(i,{componentCls:o})),Dt(i)]},e=>({zIndexPopup:e.zIndexPopupBase+80,previewOperationColor:new J(e.colorTextLightSolid).toRgbString(),previewOperationColorDisabled:new J(e.colorTextLightSolid).setAlpha(.25).toRgbString(),previewOperationSize:e.fontSizeIcon*1.5})),Ue={rotateLeft:u(Qe,null,null),rotateRight:u(Je,null,null),zoomIn:u(qe,null,null),zoomOut:u(et,null,null),close:u(tt,null,null),left:u(ot,null,null),right:u(nt,null,null),flipX:u(Ie,null,null),flipY:u(Ie,{rotate:90},null)},jt=()=>({previewPrefixCls:String,preview:it()}),Lt=ie({compatConfig:{MODE:3},name:"AImagePreviewGroup",inheritAttrs:!1,props:jt(),setup(e,o){let{attrs:i,slots:t}=o;const{prefixCls:n,rootPrefixCls:s}=Le("image",e),p=v(()=>`${n.value}-preview`),[g,S]=Ye(n),I=v(()=>{const{preview:f}=e;if(f===!1)return f;const m=typeof f=="object"?f:{};return l(l({},m),{rootClassName:S.value,transitionName:fe(s.value,"zoom",m.transitionName),maskTransitionName:fe(s.value,"fade",m.maskTransitionName)})});return()=>g(u(ze,M(M({},l(l({},i),e)),{},{preview:I.value,icons:Ue,previewPrefixCls:p.value}),t))}}),kt=Lt,K=ie({name:"AImage",inheritAttrs:!1,props:Re(),setup(e,o){let{slots:i,attrs:t}=o;const{prefixCls:n,rootPrefixCls:s,configProvider:p}=Le("image",e),[g,S]=Ye(n),I=v(()=>{const{preview:f}=e;if(f===!1)return f;const m=typeof f=="object"?f:{};return l(l({icons:Ue},m),{transitionName:fe(s.value,"zoom",m.transitionName),maskTransitionName:fe(s.value,"fade",m.maskTransitionName)})});return()=>{var f,m;const D=((m=(f=p.locale)===null||f===void 0?void 0:f.value)===null||m===void 0?void 0:m.Image)||rt.Image,d=()=>u("div",{class:`${n.value}-mask-info`},[u(at,null,null),D==null?void 0:D.preview]),{previewMask:C=i.previewMask||d}=e;return g(u(Mt,M(M({},l(l(l({},t),e),{prefixCls:n.value})),{},{preview:I.value,rootClassName:Z(e.rootClassName,S.value)}),l(l({},i),{previewMask:typeof C=="function"?C:null})))}}});K.PreviewGroup=kt;K.install=function(e){return e.component(K.name,K),e.component(K.PreviewGroup.name,K.PreviewGroup),e};export{K as I};
